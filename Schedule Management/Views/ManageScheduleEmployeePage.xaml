<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    x:Class="Schedule_Management.Views.ManageScheduleEmployeePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:Schedule_Management.Models"
    Title="Manage Employee Schedule"
    BackgroundColor="#e6f2ff">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Header -->
            <Frame Padding="20"
                   Margin="0,10,0,10"
                   BackgroundColor="#f0f8ff"
                   CornerRadius="15"
                   HasShadow="True">
                <VerticalStackLayout Spacing="5">
                    <Label Text="Add / Edit Employee Schedule"
                           FontSize="22"
                           FontAttributes="Bold"
                           TextColor="#2c5282"
                           HorizontalOptions="Center"/>
                    <Label Text="Create or update work schedule for employee"
                           FontSize="14"
                           TextColor="#4a6fa5"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Schedule Form -->
            <Frame BackgroundColor="#f0f8ff"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="True">
                <VerticalStackLayout Spacing="15">

                    <!-- e‑mail -->
                    <Frame BackgroundColor="#e2eeff" CornerRadius="10" Padding="15,5" BorderColor="#b9d7ff">
                        <VerticalStackLayout>
                            <Label Text="Employee e‑mail" FontSize="13" TextColor="#4a6fa5"/>
                            <Entry x:Name="EmployeeEmailEntry"
                                   Placeholder="Enter e‑mail"
                                   PlaceholderColor="#b9d7ff"
                                   TextColor="#2c5282"
                                   Keyboard="Email"
                                   FontSize="16"/>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- date -->
                    <Frame BackgroundColor="#e2eeff" CornerRadius="10" Padding="15,5" BorderColor="#b9d7ff">
                        <VerticalStackLayout>
                            <Label Text="Date" FontSize="13" TextColor="#4a6fa5"/>
                            <DatePicker x:Name="ScheduleDatePicker"
                                        Format="D"
                                        TextColor="#2c5282"
                                        FontSize="16"/>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- time pickers -->
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Frame Grid.Column="0" BackgroundColor="#e2eeff" CornerRadius="10" Padding="15,5" BorderColor="#b9d7ff">
                            <VerticalStackLayout>
                                <Label Text="Start time" FontSize="13" TextColor="#4a6fa5"/>
                                <Picker x:Name="TimeStartPicker" FontSize="16" TextColor="#2c5282"/>
                            </VerticalStackLayout>
                        </Frame>

                        <Frame Grid.Column="1" BackgroundColor="#e2eeff" CornerRadius="10" Padding="15,5" BorderColor="#b9d7ff">
                            <VerticalStackLayout>
                                <Label Text="End time" FontSize="13" TextColor="#4a6fa5"/>
                                <Picker x:Name="TimeEndPicker" FontSize="16" TextColor="#2c5282"/>
                            </VerticalStackLayout>
                        </Frame>
                    </Grid>

                    <!-- add / update button -->
                    <Button x:Name="AddOrUpdateButton"
                            Text="ADD SCHEDULE"
                            Clicked="OnAddOrUpdateClicked"
                            BackgroundColor="#5588c7"
                            TextColor="White"
                            FontAttributes="Bold"
                            CornerRadius="10"
                            HeightRequest="50"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Schedules List -->
            <Frame x:Name="SchedulesListFrame"
                   BackgroundColor="#f0f8ff"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="True">
                <VerticalStackLayout Spacing="15">
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <Label Text="Employee schedules"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#2c5282"/>
                        <Button Grid.Column="1"
                                Text="SEARCH"
                                BackgroundColor="#78a1d7"
                                TextColor="White"
                                CornerRadius="8"
                                HeightRequest="40"
                                WidthRequest="100"
                                Clicked="OnSearchSchedulesClicked"/>
                    </Grid>

                    <CollectionView ItemsSource="{Binding EmployeeSchedules}"
                                    SelectionMode="None"
                                    EmptyView="No schedules">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:ScheduleCard">
                                <SwipeView>
                                    <SwipeView.RightItems>
                                        <SwipeItems Mode="Reveal">
                                            <SwipeItem Text="Edit"
                                                       BackgroundColor="#5eb762"
                                                       Invoked="OnEditSchedule"/>
                                        </SwipeItems>
                                    </SwipeView.RightItems>

                                    <Frame Margin="0,6"
                                           Padding="12"
                                           BackgroundColor="#f0f8ff"
                                           BorderColor="#d4e4ff"
                                           CornerRadius="12"
                                           HasShadow="True">
                                        <Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
                                            <VerticalStackLayout>
                                                <Label FontAttributes="Bold"
                                                       FontSize="16"
                                                       TextColor="#2c5282"
                                                       Text="{Binding DateText}"/>
                                                <Label FontSize="13"
                                                       TextColor="#4a6fa5"
                                                       Text="{Binding TimeRange}"/>
                                            </VerticalStackLayout>

                                            <Frame Grid.Column="1"
                                                   Padding="6,2"
                                                   BackgroundColor="#e2eeff"
                                                   BorderColor="#b9d7ff"
                                                   CornerRadius="6"
                                                   VerticalOptions="Center">
                                                <Label FontSize="13"
                                                       FontAttributes="Bold"
                                                       Text="{Binding Status}"
                                                       TextColor="#2c5282"/>
                                            </Frame>
                                        </Grid>
                                    </Frame>
                                </SwipeView>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>